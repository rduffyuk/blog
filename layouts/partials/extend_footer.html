{{- /* Mermaid.js conditional loading - only loads if diagrams present */ -}}
{{- /* data-cfasync="false" bypasses Cloudflare Rocket Loader which breaks ES modules */ -}}
<script type="module" data-cfasync="false">
  // Only initialize Mermaid if there are mermaid blocks on the page
  if (document.querySelector('.mermaid')) {
    const mermaid = await import('https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs');
    mermaid.default.initialize({
      startOnLoad: true,
      theme: 'dark',
      themeVariables: {
        primaryColor: '#BB86FC',
        primaryTextColor: '#fff',
        primaryBorderColor: '#7c4dff',
        lineColor: '#F8B229',
        secondaryColor: '#03dac6',
        tertiaryColor: '#121212'
      }
    });
  }
</script>
