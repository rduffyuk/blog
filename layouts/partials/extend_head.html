{{- /* Favicon */ -}}
<link rel="icon" type="image/svg+xml" href="/favicon.svg">

{{- /* Mermaid.js support for diagram rendering */ -}}
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  mermaid.initialize({
    startOnLoad: false,
    theme: 'dark',
    themeVariables: {
      primaryColor: '#BB86FC',
      primaryTextColor: '#fff',
      primaryBorderColor: '#7c4dff',
      lineColor: '#F8B229',
      secondaryColor: '#03dac6',
      tertiaryColor: '#121212'
    }
  });

  // Wait for DOM to load, then convert Mermaid code blocks
  document.addEventListener('DOMContentLoaded', () => {
    // Find all code blocks with language-mermaid or fallback (Hugo quirk)
    const mermaidBlocks = document.querySelectorAll('code.language-mermaid, code[data-lang="mermaid"], pre > code:not([class])');

    mermaidBlocks.forEach((block, index) => {
      // Check if content looks like Mermaid syntax
      const content = block.textContent;
      if (content.trim().match(/^(graph|sequenceDiagram|classDiagram|stateDiagram|erDiagram|journey|gantt|pie|gitGraph|flowchart)/)) {
        // Create a new div for Mermaid to render into
        const mermaidDiv = document.createElement('div');
        mermaidDiv.className = 'mermaid';
        mermaidDiv.textContent = content;

        // Replace the code block with the Mermaid div
        const pre = block.closest('pre');
        if (pre) {
          pre.parentNode.replaceChild(mermaidDiv, pre);
        }
      }
    });

    // Initialize Mermaid rendering
    mermaid.run();
  });
</script>
